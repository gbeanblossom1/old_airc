<!DOCTYPE html>
<html>
<head>
	<title>DARCIE</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.0-12/js/all.js">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <style>.popover-body {height: 500px;overflow-y: auto;white-space:wrap;}</style>
  <style>input.form-control { width: 480px!important}</style>
  <style>
  .navbar-custom {background-color: rgb(134, 31, 65);}
  .navbar-custom .navbar-brand, .navbar-custom .navbar-text{color: rgb(255, 255, 255);} 
  </style> 
  <style>.btn-custom {background-color: rgb(198, 70, 0)!important}</style>
  <style>nav .navbar-nav li a{color: white!important}</style>
  <style>{box-sizing: border-box;}.column {width: 45%; align-items: center;}.row:after {content: "";display: table;clear: both;}</style>
  <style>table, th, td {border:1px solid black; width: 300px!important; white-space: nowrap;}</style>
  <style>body{padding-bottom: 50px}</style>
</head>
<body>

  
 
  <!-- Nav Bar -->
  <nav class="navbar navbar-expand-md navbar-custom">
    <a class="navbar-brand" href="{{ url_for('views.view_search') }}">DARCIE</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      
      <ul class="navbar-nav ml-auto">
        <li class="nav-item active">
          <a class="nav-link " href="{{ url_for('views.view_search') }}">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{{ url_for('views.view_evmForm') }}">EVM Request</a>
        </li>
      </ul>
      
    </div>
  </nav>
  
  <!-- Search Bar -->
  <section id="cover">
    <div id="cover-caption">
        <div id="container" class="container">
            <div class="row">
                <div class="col-12 offset-0 text-center">
                    <div class="info-form p-5">
                        <form action="" class="form-inline justify-content-center">
                            <button class="btn btn-light btn-custom my-sm-0 " type="button" title="Chart Info:" data-container="body" data-toggle="popover" data-html="true" data-placement="left"
                            data-content="<strong>Vendor Table:</strong>
                            <ol>
                              <li>Vendor_sam_entity_id: ID number that correlates with the vendor, which is who the contract is being awarded to
                              <li>Vendor_name: Name of the company or group that the contracting agency is purchasing from.
                              <li>Num_piids: Total number of unique contracts that has been given to them by contracting entities
                              <li>Dollars_obligated: Total amount of money given to this company throughout all of their unique contracts. 
                            </ol>
                            <strong>NAICS Table:</strong>
                            <ol> 
                              <li>Naics_description: This is the description of the product that the contract is for
                              <li>Num_piids: Total number of unique contracts given to support this product
                            	<li>Dollars_obligated: Total amount of money spent on contracts supporting this type of product
                            </ol>
                            <strong>Vendors by Unique Contracts Bar Chart:</strong>
                            <ul>
                              <li>This chart is the top 5 companies that have received government contracts, sorted by the total number of contracts they have received.
                            </ul>
                              <strong>Top NAICS Vendors by Number of Contracts</strong>
                            <ul>
                              <li>This chart is the top 5 NAICS products by total number of unique contracts
                            </ul>
                            <strong>Dollars Obligated Bar Chart</strong>
                            <ul>
                              <li>This chart is the top 5 contracting agencies sorted by the total amount of dollars they have given through contracts.
                            </ul>
                            <strong>Dollars Obligated by Fiscal Year Chart</strong>
                            <ul>
                              <li>This chart shows the total amount of money given by each fiscal year to the Defense Advanced Research Projects Agency
                            </ul>
                            <strong>Pie Chart</strong>
                            <ul>
                              <li>This pie chart shows what percentage of contracts were given out to commercial activities versus other types of activities.
                            ">
                              <i class="fas fa-chart-bar text-light"></i>
                            </button>
                            <button type="button" title="Sample SQL Queries:" class="btn btn-light btn-custom my-sm-0 " data-container="body" data-toggle="popover" data-html="true" data-placement="left" 
                            data-content="<strong>These queries will affect the data in the charts below:</strong><br>
                            <ul>
                              <li>Select piid, vendor_name, vendor_sam_entity_id, dollars_obligated, naics_description from hub_activity;
                              <li>Select commercial, vendor_name, naics_description from hub_activity;
                              <li>Select contracting_agency_name, vendor_name, dollars_obligated from hub_activity limit 100;
                              <li>Select piid, vendor_name, contracting_agency_name from hub_activity where contracting_agency_name='
                                DEFENSE ADVANCED RESEARCH PROJECTS AGENCY  (DARPA)'
                              <li>Select piid, vendor_name, contracting_agency_name, canonical_date from hub_activity where canonical_date between '01/01/2015' and '01/01/2017'
                            </ul>
                            <strong>Each query consists of the following items:</strong>
                            <ol>
                              <li> Select statement<br>
                              <ul> 
                              <li>This goes at the beginning of each SQL query
                              </ul>
                              <li> List of columns
                              <ul>
                              <li>These follow the word select. You can choose as many columns as you want, each separated by a comma.
                              </ul>
                              <li> Database queried
                              <ul>
                              <li>This will be “from hub_activity” for each query in this user interface
                              </ul>
                              <li> Semi-colon
                              <ul>
                              <li>Each query will end with a semi-colon
                              </ul>
                              </ol>
                              From this, if we wanted to search over the columns “vendor_name”, ”dollars_obligated”, ”canonical_date”, we would write the query as:<br>
                              <Strong>Select vendor_name, dollars_obligated, canonical_date from hub_activity;</Strong>
                              ">
                              <i class="fas fa-question-circle text-light"></i>

                            </button>
                            
                            <input class="form-control mx-sm-2" type="search" placeholder="Search" value="select * from hub_activity limit 1000" aria-label="Search" id="sQuery">
                            <button class="btn btn-light btn-custom my-sm-0 " type="submit" id="searchSubmit" title="Search">
                              <i class="fas fa-search text-light"></i>
                            </button>
                            <button class="btn btn-light btn-custom my-sm-0" type="button" id="download" title="Export Data">
                              <!--Light-->
                              <i class="fas fa-download text-light"></i>
                              <!--Dark-->
                              <!-- <i class="fas fa-download text-light"></i> -->
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Table for search results -->
    <div class="table-responsive" style="display:none" id="sql_search_results_table">
      <table class="table table-bordered table-hover" id="dataTable" width="100%" cellspacing="0">
          <thead>
              <tr>
                  <th>Name</th>
                  <th>Number of Files</th>
                  <th>Date Uploaded</th>
                  <th></th>
              </tr>
          </thead>
          <tbody id="sql_search_results_table_body">
          </tbody>
      </table>
  </div>
  </section>

  <!-- Graph -->
  <section id="graphs">
    <div id="container" class="container padding">
      <div class='row' >
        <div class="column mx-auto p-5">
          <table id="vendorTable" title="Vendor Table" style="overflow: scroll; display: block; height:150px!important; width: 300px!important;"><h>Vendor Table</h></table>
          <table id="naicsTable" title="NAICS Table" style="overflow: scroll; display: block; height:150px!important; width: 300px!important;"><h>NAICS Table</h></table>
        </div>
        <div class="column mx-auto">
          <canvas id="vendorBar" title="Vendor Bar Chart"></canvas> <!-- Top 5 SEI numbers (Displayed as vendors) by number of unique PIIDs-->
          <canvas id="naicsBar" title="NAICS Bar Chart"></canvas> <!-- Top 5 unique PIIDs with NAICS descriptions-->
        </div>
        
      </div>
      <div class="column ml auto"style="height: 40%; width: 30%; display: flex;">
        <canvas id="oblBar" title="Dollars Obligated Bar Chart"></canvas> <!-- Dollars Obligated by Organization-->
        <canvas id="darpaLine" title="Darpa Line Chart"></canvas> <!-- Dollars Obligated by Fiscal Year-->
        <canvas id="commercialPie" title="Comercial Pie Chart"></canvas> <!-- Commercial items vs not-->
      </div>
      <div class="flex-column-reverse">
        <div class=" offset-0">
          
        </div>
        
      </div>
    </div>
  </section>

  <!-- results page-->
  <section id="results">
  </section>

 <!-- Graph JS Links -->
 <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
 <script src="{{ url_for('static', filename='js/search_charts.js') }}"></script>

  <!-- Search JS-->
  <script>
    
    window.onload=function(){
      const qv = "select * from hub_activity limit 1000";
      const su = {{(url_root + url_for("query.sql_search")) | tojson}}
      performSearch(su, qv);
      
    };
    
    searchSubmit.addEventListener('click', searchFunc);
    function searchFunc(event) {
      event.preventDefault();
      
      var queryValue = document.getElementById('sQuery').value;
      if (queryValue === null || queryValue === '') return;

      const searchUrl = {{(url_root + url_for("query.sql_search")) | tojson}};
      performSearch(searchUrl, queryValue);
    };

    download.addEventListener('click', downloadFunc);
    function downloadFunc(event) {
      event.preventDefault();

      var queryValue = document.getElementById('sQuery').value;
      if (queryValue === null || queryValue === '') return;

      const searchUrl = {{(url_root + url_for("query.sql_search")) | tojson}};
      downloadHelper(searchUrl, queryValue);
    }
  </script>
  
</body>
</html>






<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Poppins:100,200,300,400&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

</script>